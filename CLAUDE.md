# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Docusaurus 3.7.0-based documentation site for SSAPI, a Korean streaming API service that provides real-time chat and donation data from Soop (AfreecaTV) and Chzzk platforms. The site features a custom landing page with animations and comprehensive API documentation.

**Key Technologies:**
- Docusaurus 3.7.0 (React-based static site generator)
- React 18
- SCSS modules for component styling
- Framer Motion for animations
- OpenAPI 3.0 for REST API documentation auto-generation

## Development Commands

### Common Commands

```bash
# Start development server (hot reload enabled)
npm start
# or
npm run dev

# Production build
npm run build

# Serve production build locally for testing
npm run serve

# Clear Docusaurus cache (use when experiencing build issues)
npm run clear
```

### API Documentation

```bash
# Regenerate REST API documentation from OpenAPI spec
npm run rest-api-generate
```

This command processes `schemas/rest-api.yaml` and generates individual `.api.mdx` files in `docs/rest-api/`. Run this after modifying the OpenAPI specification.

### Internationalization

```bash
# Extract translatable strings to i18n folder
npm run write-translations

# Add IDs to markdown headings for better i18n support
npm run write-heading-ids
```

### Utility Scripts

```bash
# Optimize project images (Python script)
python bin/image_processor.py
```

Resizes images to max 200x200px, converts to PNG, removes metadata, and tracks processed files.

## Architecture Overview

### Custom Landing Page + Documentation Hybrid

Unlike typical Docusaurus sites, this project uses a **custom React landing page** (`src/pages/index.js`) instead of the default docs homepage. The landing page is marketing-focused with animated sections, while documentation is accessed via the navbar.

### Directory Structure

```
ssapi-doc/
â”œâ”€â”€ docs/                    # Markdown documentation files
â”‚   â”œâ”€â”€ intro/              # Introduction pages
â”‚   â”œâ”€â”€ socket/             # Socket API documentation
â”‚   â”œâ”€â”€ rest-api/           # Auto-generated REST API docs
â”‚   â”œâ”€â”€ schemas/            # Data schema definitions (.schema.mdx)
â”‚   â”œâ”€â”€ additional/         # Reference tables and policies
â”‚   â””â”€â”€ contact/            # Contact information
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Landing/        # Landing page sections (Hero, Features, etc.)
â”‚   â”‚   â””â”€â”€ Docs/           # Documentation-specific components
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â””â”€â”€ index.js        # Custom landing page (overrides default)
â”‚   â””â”€â”€ css/
â”‚       â””â”€â”€ custom.css      # Global theme overrides
â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ rest-api.yaml       # OpenAPI 3.0 spec (source of truth for REST API)
â”‚   â””â”€â”€ projects.json       # Project showcase data
â”œâ”€â”€ static/img/             # Static assets (logos, screenshots, etc.)
â”œâ”€â”€ blog/                   # Blog posts (.mdx)
â””â”€â”€ bin/                    # Python utility scripts
```

### Key Files

- **`docusaurus.config.js`** - Site configuration, plugins, navbar, footer
- **`sidebars.js`** - Sidebar configuration (currently using autogenerated from docs structure)
- **`schemas/rest-api.yaml`** - OpenAPI spec that auto-generates REST API documentation
- **`schemas/projects.json`** - Data for project showcases on landing page
- **`src/pages/index.js`** - Custom landing page entry point

### Component Architecture

**Landing Page Sections** (`src/components/Landing/`):
- Modular, self-contained components with `.module.scss` styling
- Data-driven (reads from `schemas/projects.json`)
- Framer Motion animations for visual appeal
- Sections: Hero, Metrics, Features, MinecraftSupport, SuccessStories, FeaturedProjects, ProjectsList, Statistics, CTA

**Documentation Components** (`src/components/Docs/`):
- Reusable components for documentation pages
- Examples: OtherProjects, PartnerCards, ProjectHistory, ServerList

### OpenAPI-First REST API Documentation

The REST API documentation is **auto-generated** from `schemas/rest-api.yaml`:

1. Edit `schemas/rest-api.yaml` to add/modify endpoints
2. Run `npm run rest-api-generate` to regenerate docs
3. Individual `.api.mdx` files are created in `docs/rest-api/`
4. Sidebar is auto-generated and grouped by OpenAPI tags

**Important:** Never manually edit files in `docs/rest-api/` - they will be overwritten. Always edit the source YAML file.

### Styling Patterns

- **Component-scoped styles**: Use `.module.scss` files for component-specific styles
- **Global overrides**: Use `src/css/custom.css` for theme-wide customization
- **CSS variables**: Defined in `custom.css` for theming (light/dark mode)
- **SCSS support**: Enabled via `docusaurus-plugin-sass`

### Sidebar and Navigation

The sidebar is **auto-generated** from the `docs/` folder structure:

- Controlled by `_category_.json` files in each directory
- Ordering via `sidebar_position` frontmatter in markdown files
- Emoji labels are set in `_category_.json` (e.g., "ðŸ’š Socket API")

To add a new documentation page:
1. Create `.md` or `.mdx` file in appropriate `docs/` subdirectory
2. Add frontmatter with `sidebar_position` if needed
3. Sidebar will auto-update on next build

## Common Development Tasks

### Adding a New Documentation Page

1. Create markdown file in appropriate `docs/` subdirectory:
   ```markdown
   ---
   sidebar_position: 3
   title: My New Page
   ---

   # Content here
   ```

2. The sidebar will automatically include it based on folder structure

### Modifying the Landing Page

1. Edit components in `src/components/Landing/`
2. Each section is self-contained with its own styling
3. Update component imports in `src/pages/index.js` if adding new sections

### Adding a Project to Showcase

1. Add project data to `schemas/projects.json`
2. Add project image to `static/img/projects/`
3. Run `python bin/image_processor.py` to optimize the image
4. Image will automatically appear on landing page

### Updating REST API Documentation

1. Edit `schemas/rest-api.yaml` using OpenAPI 3.0 syntax
2. Run `npm run rest-api-generate`
3. Verify generated docs in `docs/rest-api/`
4. Commit both the YAML and generated `.api.mdx` files

### Working with Images

- Place images in `static/img/` subdirectories (organized by purpose)
- Reference in markdown as `/img/path/to/image.png`
- Use `python bin/image_processor.py` to batch optimize images
- Script creates backups and logs processing details

## Plugin Configuration

### docusaurus-plugin-openapi-docs

Configured in `docusaurus.config.js`:
```javascript
{
  id: "rest-api",
  config: {
    ssapi: {
      specPath: "schemas/rest-api.yaml",
      outputDir: "docs/rest-api",
      sidebarOptions: { groupPathsBy: "tag" },
      showSchemas: true
    }
  }
}
```

### Custom DocItemComponent

The site uses a custom API documentation component:
```javascript
docs: {
  docItemComponent: "@theme/ApiItem"
}
```

This is provided by `docusaurus-theme-openapi-docs` for enhanced API documentation rendering.

## Internationalization (i18n)

The site is configured for Korean (`ko-KR`) as the default locale:
```javascript
i18n: {
  defaultLocale: "ko-KR",
  locales: ["ko-KR"]
}
```

Translation files are organized in `i18n/ko-KR/`:
- `docusaurus-plugin-content-docs/` - Documentation translations
- `docusaurus-plugin-content-blog/` - Blog translations
- `docusaurus-theme-classic/` - Theme UI translations

## Build and Deployment

### Local Testing

```bash
npm run build
npm run serve
```

Access at `http://localhost:3000`

### Important Build Notes

- The site builds to the `build/` directory (gitignored)
- Static assets from `static/` are copied to `build/` root
- Auto-generated REST API docs must be regenerated if the YAML changes
- Clear cache (`npm run clear`) if experiencing unexpected build behavior

## Git Workflow

- **Main branch**: `main`
- **Current branch**: `features`
- Edit URLs point to GitHub: `https://github.com/DOCHIS/ssapi-doc`
- Husky hooks are configured in `.husky/` for pre-commit checks

## Project Context

SSAPI has processed 500ì–µ+ requests since February 2024, serving ~2,500 streamers and ~100 developers. The documentation emphasizes:
- Performance optimization (low bandwidth usage)
- Ease of integration
- Bilingual support (Korean primary, expandable to other languages)
- Real-time Socket.IO API alongside REST API

## Common Gotchas

1. **Don't edit files in `docs/rest-api/` directly** - they're auto-generated from `schemas/rest-api.yaml`
2. **Custom homepage** - The default Docusaurus homepage is replaced by `src/pages/index.js`
3. **SCSS imports** - Use `.module.scss` for component styles, not inline CSS
4. **Image paths** - In markdown, reference as `/img/...` (no `static/` prefix)
5. **Sidebar auto-generation** - Controlled by folder structure and `_category_.json` files, not `sidebars.js`
