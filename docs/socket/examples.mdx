---
sidebar_position: 1
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# 구현 예제

## 언어별 Socket.IO 클라이언트 예제

각 프로그래밍 언어별 Socket.IO 클라이언트 구현 예제입니다. 모든 예제는 소켓 연결, 인증, 데이터 수신 및 압축 해제 과정을 포함하고 있습니다.

<Tabs>
<TabItem value="nodejs" label="Node.js">

```javascript
const io = require("socket.io-client");
const { uncompressSync } = require("snappy");

// 소켓 연결 설정
const socket = io("https://socket.ssapi.kr", {
  transports: ["websocket"],
  timeout: 5000,
});

// 소켓 연결 성공 시 이벤트
socket.on("connect", () => {
  console.log("소켓 연결 성공");
  socket.emit("login", "<API KEY 입력>");
});

// 소켓 연결 해제 시 이벤트
socket.on("disconnect", (reason) => {
  console.error("소켓 연결 끊김", reason);
});

// 채팅 메시지 수신 및 압축 해제
socket.on("chat", (compressedData) => {
  try {
    const decompressedData = uncompressSync(compressedData);
    const data = JSON.parse(decompressedData.toString());
    console.log("수신된 압축 해제 메시지", data);
  } catch (error) {
    console.error("메시지 압축 해제 중 오류:", error);
  }
});

// 후원 데이터 수신 및 압축 해제
socket.on("donation", (compressedData) => {
  try {
    const decompressedData = uncompressSync(compressedData);
    const data = JSON.parse(decompressedData.toString());
    console.log("수신된 압축 해제 후원 데이터", data);
  } catch (error) {
    console.error("후원 데이터 압축 해제 중 오류:", error);
  }
});
```

</TabItem>
<TabItem value="python" label="Python">

```python
import socketio
import snappy
import json

# 소켓 연결 클라이언트 생성
sio = socketio.Client()

# 소켓 연결 이벤트
@sio.event
def connect():
    print("소켓 연결 성공")
    sio.emit("login", "<API KEY 입력>")

# 소켓 연결 해제 이벤트
@sio.event
def disconnect():
    print("소켓 연결 끊김")

# 채팅 메시지 수신 및 압축 해제
@sio.event
def chat(compressed_data):
    try:
        decompressed_data = snappy.decompress(compressed_data)
        data = json.loads(decompressed_data.decode('utf-8'))
        print("수신된 압축 해제 메시지:", data)
    except Exception as e:
        print("메시지 압축 해제 중 오류:", e)

# 후원 데이터 수신 및 압축 해제
@sio.event
def donation(compressed_data):
    try:
        decompressed_data = snappy.decompress(compressed_data)
        data = json.loads(decompressed_data.decode('utf-8'))
        print("수신된 압축 해제 후원 데이터:", data)
    except Exception as e:
        print("후원 데이터 압축 해제 중 오류:", e)

# 소켓 연결
sio.connect("https://socket.ssapi.kr", transports=["websocket"], timeout=5)
```

</TabItem>
<TabItem value="browser" label="Javascript (브라우저)">

```html
<!DOCTYPE html>
<html>
  <head>
    <!-- 소켓 통신 라이브러리 -->
    <script
      src="https://cdn.socket.io/4.6.0/socket.io.min.js"
      integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+"
      crossorigin="anonymous"
    ></script>

    <!-- Snappy 압축 해제 라이브러리 -->
    <script src="https://cdn.ssapi.kr/service/snappyjs.min.js"></script>
  </head>

  <body>
    <script>
      // Snappy 초기화
      const socket = io("https://socket.ssapi.kr", {
        transports: ["websocket"],
        timeout: 5000,
      });

      // 소켓 연결
      socket.on("connect", () => {
        console.log("소켓 연결 성공");
        socket.emit("login", "<API KEY 입력>");
      });

      // 소켓 연결 끊김
      socket.on("disconnect", (reason) => {
        console.error("소켓 연결 끊김", reason);
      });

      // 메시지 수신 및 압축 해제
      socket.on("chat", (compressedData) => {
        try {
          const decompressedData = SnappyJS.uncompress(compressedData);
          const data = JSON.parse(new TextDecoder().decode(decompressedData));
          console.log("수신된 압축 해제 메시지", data);
        } catch (error) {
          console.error("메시지 압축 해제 중 오류:", error);
        }
      });

      // 후원 데이터 수신 및 압축 해제
      socket.on("donation", (compressedData) => {
        try {
          const decompressedData = SnappyJS.uncompress(compressedData);
          const data = JSON.parse(new TextDecoder().decode(decompressedData));
          console.log("수신된 압축 해제 후원 데이터", data);
        } catch (error) {
          console.error("후원 데이터 압축 해제 중 오류:", error);
        }
      });
    </script>
  </body>
</html>
```

</TabItem>
<TabItem value="java" label="Java">

```java
import io.socket.client.IO;
import io.socket.client.Socket;
import io.socket.emitter.Emitter;
import org.json.JSONObject;
import org.xerial.snappy.Snappy;

import java.nio.charset.StandardCharsets;

public class SocketExample {
    public static void main(String[] args) {
        try {
            // 소켓 연결 옵션 설정
            IO.Options options = new IO.Options();
            options.transports = new String[]{"websocket"};
            options.timeout = 5000; // 5초

            Socket socket = IO.socket("https://socket.ssapi.kr", options);

            // 소켓 연결 시 이벤트 핸들러
            socket.on(Socket.EVENT_CONNECT, args1 -> {
                System.out.println("소켓 연결 성공");
                socket.emit("login", "<API KEY 입력>");
            });

            // 소켓 연결 해제 시 이벤트 핸들러
            socket.on(Socket.EVENT_DISCONNECT, args12 -> {
                String reason = args12[0].toString();
                System.err.println("소켓 연결 끊김: " + reason);
            });

            // 채팅 메시지 수신 및 압축 해제
            socket.on("chat", args13 -> {
                try {
                    byte[] compressed = (byte[]) args13[0];
                    String parsed = Snappy.uncompressString(compressed);
                    JSONObject jsonData = new JSONObject(parsed);
                    System.out.println("수신된 압축 해제 메시지: " + jsonData);
                } catch (Exception e) {
                    System.err.println("메시지 압축 해제 중 오류: " + e.getMessage());
                }
            });

            // 후원 데이터 수신 및 압축 해제
            socket.on("donation", args14 -> {
                try {
                    byte[] compressed = (byte[]) args14[0];
                    String parsed = Snappy.uncompressString(compressed);
                    JSONObject jsonData = new JSONObject(parsed);
                    System.out.println("수신된 압축 해제 후원 데이터: " + jsonData);
                } catch (Exception e) {
                    System.err.println("후원 데이터 압축 해제 중 오류: " + e.getMessage());
                }
            });

            // 소켓 연결
            socket.connect();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

</TabItem>
<TabItem value="go" label="Go">

```go
package main

import (
    "encoding/json"
    "fmt"
    "log"

    socketio "github.com/googollee/go-socket.io-client"
    "github.com/golang/snappy"
)

func main() {
    // 소켓 연결 옵션 설정
    opts := &socketio.Options{
        Transport: "websocket",
        Query:     make(map[string]string),
    }

    // 소켓 클라이언트 생성
    client, err := socketio.NewClient("https://socket.ssapi.kr", opts)
    if err != nil {
        log.Fatal(err)
    }

    // 소켓 연결 이벤트
    client.OnConnect(func() {
        fmt.Println("소켓 연결 성공")
        client.Emit("login", "<API KEY 입력>")
    })

    // 소켓 연결 해제 이벤트
    client.OnDisconnect(func() {
        fmt.Println("소켓 연결 끊김")
    })

    // 채팅 메시지 수신 및 압축 해제
    client.On("chat", func(data []byte) {
        try {
            // 압축 해제
            decompressed, err := snappy.Decode(nil, data)
            if err != nil {
                log.Printf("메시지 압축 해제 중 오류: %v", err)
                return
            }

            // JSON 파싱
            var jsonData map[string]interface{}
            if err := json.Unmarshal(decompressed, &jsonData); err != nil {
                log.Printf("JSON 파싱 중 오류: %v", err)
                return
            }

            fmt.Printf("수신된 압축 해제 메시지: %+v\n", jsonData)
        } catch (error) {
            log.Printf("메시지 처리 중 오류: %v", error)
        }
    })

    // 후원 데이터 수신 및 압축 해제
    client.On("donation", func(data []byte) {
        try {
            // 압축 해제
            decompressed, err := snappy.Decode(nil, data)
            if err != nil {
                log.Printf("후원 데이터 압축 해제 중 오류: %v", err)
                return
            }

            // JSON 파싱
            var jsonData map[string]interface{}
            if err := json.Unmarshal(decompressed, &jsonData); err != nil {
                log.Printf("JSON 파싱 중 오류: %v", err)
                return
            }

            fmt.Printf("수신된 압축 해제 후원 데이터: %+v\n", jsonData)
        } catch (error) {
            log.Printf("후원 데이터 처리 중 오류: %v", error)
        }
    })

    // 소켓 연결
    err = client.Connect()
    if err != nil {
        log.Fatal(err)
    }

    // 프로그램 종료 방지
    select {}
}
```

</TabItem>
<TabItem value="php" label="PHP">

```php
<?php

require 'vendor/autoload.php';

use ElephantIO\Client;
use ElephantIO\Engine\SocketIO\Version4X;

class SocketClient {
    private $client;

    public function __construct() {
        $this->client = new Client(new Version4X(
            'https://socket.ssapi.kr',
            [
                'transport' => 'websocket',
                'timeout' => 5000
            ]
        ));
    }

    public function connect() {
        try {
            // 소켓 연결
            $this->client->initialize();
            echo "소켓 연결 성공\n";

            // 로그인
            $this->client->emit('login', '<API KEY 입력>');

            // 이벤트 리스닝
            while (true) {
                $message = $this->client->read();

                if ($message) {
                    switch ($message->event) {
                        case 'chat':
                            $this->handleChat($message->data);
                            break;
                        case 'donation':
                            $this->handleDonation($message->data);
                            break;
                    }
                }
            }
        } catch (Exception $e) {
            echo "오류 발생: " . $e->getMessage() . "\n";
        }
    }

    private function handleChat($compressedData) {
        try {
            $decompressedData = snappy_uncompress($compressedData);
            $data = json_decode($decompressedData, true);
            echo "수신된 압축 해제 메시지: " . json_encode($data, JSON_UNESCAPED_UNICODE) . "\n";
        } catch (Exception $e) {
            echo "메시지 압축 해제 중 오류: " . $e->getMessage() . "\n";
        }
    }

    private function handleDonation($compressedData) {
        try {
            $decompressedData = snappy_uncompress($compressedData);
            $data = json_decode($decompressedData, true);
            echo "수신된 압축 해제 후원 데이터: " . json_encode($data, JSON_UNESCAPED_UNICODE) . "\n";
        } catch (Exception $e) {
            echo "후원 데이터 압축 해제 중 오류: " . $e->getMessage() . "\n";
        }
    }
}

// 클라이언트 사용
$client = new SocketClient();
$client->connect();
```

</TabItem>
<TabItem value="rust" label="Rust">

```rust
use serde_json::Value;
use socket_io_client::ClientBuilder;
use snap::raw::Decoder;
use std::error::Error;
use tokio;

#[tokio::main]
async fn main() -> Result<(), Box<dyn Error>> {
    // 소켓 클라이언트 생성
    let socket = ClientBuilder::new("https://socket.ssapi.kr")
        .transport_type(socket_io_client::TransportType::Websocket)
        .connect()
        .await?;

    // 소켓 연결 이벤트
    socket.on("connect", |_| {
        println!("소켓 연결 성공");
        socket.emit("login", "<API KEY 입력>").unwrap();
    });

    // 소켓 연결 해제 이벤트
    socket.on("disconnect", |reason: String| {
        println!("소켓 연결 끊김: {}", reason);
    });

    // 채팅 메시지 수신 및 압축 해제
    socket.on("chat", |compressed_data: Vec<u8>| {
        match handle_compressed_data(&compressed_data) {
            Ok(data) => println!("수신된 압축 해제 메시지: {}", data),
            Err(e) => eprintln!("메시지 압축 해제 중 오류: {}", e),
        }
    });

    // 후원 데이터 수신 및 압축 해제
    socket.on("donation", |compressed_data: Vec<u8>| {
        match handle_compressed_data(&compressed_data) {
            Ok(data) => println!("수신된 압축 해제 후원 데이터: {}", data),
            Err(e) => eprintln!("후원 데이터 압축 해제 중 오류: {}", e),
        }
    });

    // 프로그램 종료 방지
    tokio::signal::ctrl_c().await?;
    Ok(())
}

fn handle_compressed_data(compressed_data: &[u8]) -> Result<Value, Box<dyn Error>> {
    let mut decoder = Decoder::new();
    let decompressed_data = decoder.decompress_vec(compressed_data)?;
    let json_data: Value = serde_json::from_slice(&decompressed_data)?;
    Ok(json_data)
}
```

</TabItem>
</Tabs>

## 필요한 라이브러리

각 언어별로 필요한 라이브러리는 다음과 같습니다:

### Node.js

- Socket.IO 클라이언트: `socket.io-client@4.6.0`
- Snappy: `snappy`

### Python

- Socket.IO 클라이언트: `python-socketio`
- Snappy: `python-snappy`

### Javascript(브라우저)

- Socket.IO 클라이언트: `socket.io-client@4.6.0`
- Snappy 압축 해제: `snappyjs`

### Java

- Socket.IO 클라이언트: `socket.io-client`
- Snappy: `org.xerial.snappy`
- JSON: `org.json`

### Go

- Socket.IO 클라이언트: `github.com/googollee/go-socket.io-client`
- Snappy: `github.com/golang/snappy`

### PHP

- Socket.IO 클라이언트: `elephantio/elephant.io`
- Snappy: `ext-snappy`

### Rust

- Socket.IO 클라이언트: `socket-io-client`
- Snappy: `snap`
- JSON 처리: `serde_json`
- 비동기 런타임: `tokio`

:::tip
각 예제는 기본적인 구현을 보여주는 것이며, 실제 프로덕션 환경에서는 에러 처리, 재연결 로직, 로깅 등을 추가하는 것을 권장합니다.
:::

:::caution 주의사항
Node.js, Python, Javascript (브라우저), Java를 제외한 다른 언어의 예시 코드는 AI가 생성한 것으로, 실제 동작을 완전히 보장하지 않을 수 있습니다. 해당 코드들은 참고용으로만 사용하시기 바랍니다.
:::
